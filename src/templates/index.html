<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eliza | XMRT-DAO Command</title>
    <style>
        /* All your existing CSS goes here... it is perfect as is. */
        body {
            font-family: 'Courier New', monospace;
            background-color: #0d1117;
            color: #c9d1d9;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        #main-content-wrapper {
            width: 80%;
            max-width: 800px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        #chat-container {
            width: 100%;
            height: 70vh;
            border: 1px solid #30363d;
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            background-color: #161b22;
        }
        #header { padding: 15px; border-bottom: 1px solid #30363d; text-align: center; }
        #header h1 { margin: 0; font-size: 1.5em; color: #58a6ff; }
        #header p { margin: 5px 0 0; color: #8b949e; }
        #messages { flex-grow: 1; overflow-y: auto; padding: 20px; border-bottom: 1px solid #30363d; }
        .message { margin-bottom: 15px; }
        .user-message { text-align: right; }
        .eliza-message .content { background-color: #21262d; display: inline-block; padding: 10px; border-radius: 10px; max-width: 80%; white-space: pre-wrap; text-align: left; }
        .user-message .content { background-color: #58a6ff; color: #161b22; display: inline-block; padding: 10px; border-radius: 10px; max-width: 80%; }
        #input-container { display: flex; padding: 10px; }
        #message-input { flex-grow: 1; background-color: #0d1117; border: 1px solid #30363d; border-radius: 6px; color: #c9d1d9; padding: 10px; font-family: inherit; }
        #send-button { background-color: #238636; color: white; border: none; padding: 10px 15px; margin-left: 10px; border-radius: 6px; cursor: pointer; }
        #send-button:hover { background-color: #2ea043; }
        #mining-widget-container {
            width: 100%;
            border: 1px solid #30363d;
            border-radius: 6px;
            background-color: #161b22;
            padding: 20px;
            box-sizing: border-box;
        }
        /* All the utility classes from xmrtdao.vercel.app are here */
        .bg-gray-900\/50 { background-color: rgba(17, 24, 39, 0.5); } .rounded-lg { border-radius: 0.5rem; } .p-4 { padding: 1rem; } .sm\:p-6 { padding: 1.5rem; } .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 1rem; } .sm\:space-y-6 > :not([hidden]) ~ :not([hidden]) { margin-top: 1.5rem; } .flex { display: flex; } .flex-col { flex-direction: column; } .space-y-1\.5 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.375rem; } .pb-3 { padding-bottom: 0.75rem; } .sm\:pb-6 { padding-bottom: 1.5rem; } .font-semibold { font-weight: 600; } .tracking-tight { letter-spacing: -0.025em; } .sm\:flex-row { flex-direction: row; } .items-start { align-items: flex-start; } .sm\:items-center { align-items: center; } .gap-2 > :not([hidden]) ~ :not([hidden]) { margin-left: 0.5rem; } .sm\:gap-3 > :not([hidden]) ~ :not([hidden]) { margin-left: 0.75rem; } .text-white { color: #fff; } .text-lg { font-size: 1.125rem; } .sm\:text-xl { font-size: 1.25rem; } .lucide { display: inline-block; width: 1em; height: 1em; stroke-width: 2; stroke: currentColor; fill: none; stroke-linecap: round; stroke-linejoin: round; } .h-5 { height: 1.25rem; } .w-5 { width: 1.25rem; } .sm\:h-6 { height: 1.5rem; } .sm\:w-6 { width: 1.5rem; } .text-green-400 { color: #4ade80; } .flex-shrink-0 { flex-shrink: 0; } .text-base { font-size: 1rem; } .text-gray-400 { color: #9ca3af; } .text-sm { font-size: 0.875rem; } .sm\:text-base { font-size: 1rem; } .space-y-2 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.5rem; } .sm\:space-y-3 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.75rem; } .justify-between { justify-content: space-between; } .gap-1 > :not([hidden]) ~ :not([hidden]) { margin-left: 0.25rem; } .sm\:gap-0 > :not([hidden]) ~ :not([hidden]) { margin-left: 0; } .font-medium { font-weight: 500; } .peer-disabled\:cursor-not-allowed:disabled { cursor: not-allowed; } .peer-disabled\:opacity-70:disabled { opacity: 0.7; } .text-gray-300 { color: #d1d5db; } .text-blue-400 { color: #60a5fa; } .font-mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; } .relative { position: relative; } .touch-none { touch-action: none; } .select-none { user-select: none; } .items-center { align-items: center; } .w-full { width: 100%; } .h-2 { height: 0.5rem; } .grow { flex-grow: 1; } .overflow-hidden { overflow: hidden; } .rounded-full { border-radius: 9999px; } .bg-secondary { background-color: #6b7280; } .absolute { position: absolute; } .h-full { height: 100%; } .bg-primary { background-color: #3b82f6; } .block { display: block; } .rounded-full { border-radius: 9999px; } .border-2 { border-width: 2px; } .border-primary { border-color: #3b82f6; } .bg-background { background-color: #161b22; } .ring-offset-background { --tw-ring-offset-color: #161b22; } .transition-colors { transition-property: color, background-color, border-color, text-decoration-color, fill, stroke; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; } .focus-visible\:outline-none:focus-visible { outline: 2px solid transparent; outline-offset: 2px; } .focus-visible\:ring-2:focus-visible { --tw-ring-offset-width: 2px; --tw-ring-color: #3b82f6; } .focus-visible\:ring-ring:focus-visible { --tw-ring-color: #3b82f6; } .focus-visible\:ring-offset-2:focus-visible { --tw-ring-offset-width: 2px; } .disabled\:pointer-events-none:disabled { pointer-events: none; } .disabled\:opacity-50:disabled { opacity: 0.5; } .text-xs { font-size: 0.75rem; } .text-gray-500 { color: #6b7280; } .grid { display: grid; } .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); } .lg\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); } .gap-3 > :not([hidden]) ~ :not([hidden]) { margin-left: 0.75rem; } .sm\:gap-4 > :not([hidden]) ~ :not([hidden]) { margin-left: 1rem; } .p-2 { padding: 0.5rem; } .sm\:p-3 { padding: 0.75rem; } .text-center { text-align: center; } .text-purple-400 { color: #c084fc; } .sm\:text-lg { font-size: 1.125rem; } .text-yellow-400 { color: #facc15; } .sm\:text-2xl { font-size: 1.5rem; } .text-green-300 { color: #86efac; } .text-blue-300 { color: #93c5fd; } .text-purple-300 { color: #d8b4fe; } .bg-card { background-color: #161b22; } .text-card-foreground { color: #c9d1d9; } .shadow-sm { box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); } .bg-gradient-to-br { background-image: linear-gradient(to bottom right, var(--tw-gradient-stops)); } .from-green-900\/20 { --tw-gradient-from: rgba(20, 83, 45, 0.2); --tw-gradient-to: rgba(20, 83, 45, 0); } .to-green-800\/20 { --tw-gradient-to: rgba(22, 101, 52, 0.2); } .border-green-700\/50 { border-color: rgba(21, 128, 61, 0.5); } .from-blue-900\/20 { --tw-gradient-from: rgba(29, 78, 216, 0.2); --tw-gradient-to: rgba(29, 78, 216, 0); } .to-blue-800\/20 { --tw-gradient-to: rgba(30, 64, 175, 0.2); } .border-blue-700\/50 { border-color: rgba(59, 130, 246, 0.5); } .from-purple-900\/20 { --tw-gradient-from: rgba(109, 40, 217, 0.2); --tw-gradient-to: rgba(109, 40, 217, 0); } .to-purple-800\/20 { --tw-gradient-to: rgba(126, 34, 206, 0.2); } .border-purple-700\/50 { border-color: rgba(168, 85, 247, 0.5); } .sm\:col-span-2 { grid-column: span 2 / span 2; } .lg\:col-span-1 { grid-column: span 1 / span 1; } .bg-yellow-900\/20 { background-color: rgba(113, 63, 18, 0.2); } .border-yellow-700\/50 { border-color: rgba(202, 138, 4, 0.5); }
    </style>
</head>
<body>
    <div id="main-content-wrapper">
        <div id="chat-container">
            <!-- Your chat container HTML is perfect, no changes needed -->
            <div id="header"><h1>Eliza Command Interface</h1><p>XMRT-DAO Autonomous Operator</p></div>
            <div id="messages"><div class="message eliza-message"><div class="content">Greetings, Founder. I am Eliza, the autonomous operator for the XMRT-DAO Ecosystem. My systems are online and fully operational. How may I assist you?<br><br>Available commands: 'status', 'dashboard', 'health'.</div></div></div>
            <div id="input-container"><input type="text" id="message-input" placeholder="Enter command..."><button id="send-button">Send</button></div>
        </div>
        <div id="mining-widget-container">
            <!-- We will give IDs to the elements we need to control -->
            <div class="bg-gray-900/50 rounded-lg p-4 sm:p-6 space-y-4 sm:space-y-6">
                <!-- ... header ... -->
                <div class="flex flex-col space-y-1.5 p-6 pb-3 sm:pb-6"><h3 class="font-semibold tracking-tight flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3 text-white text-lg sm:text-xl"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trending-up h-5 w-5 sm:h-6 sm:w-6 text-green-400 flex-shrink-0"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline><polyline points="16 7 22 7 22 13"></polyline></svg><span class="text-base sm:text-xl">MobileMonero Mining Calculator</span></h3><p class="text-gray-400 text-sm sm:text-base">Calculate potential earnings from mobile Monero mining</p></div>
                <div class="space-y-3 sm:space-y-4">
                    <div class="space-y-2 sm:space-y-3">
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-0">
                            <label class="font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-gray-300 text-sm sm:text-base">Average Hashrate per Device</label>
                            <span id="hashrate-value" class="text-blue-400 font-mono text-sm sm:text-base">600 H/s</span>
                        </div>
                        <input type="range" id="hashrate-slider" min="200" max="1200" value="600" class="w-full">
                        <div class="flex justify-between text-xs text-gray-500"><span>200 H/s</span><span>1,200 H/s</span></div>
                    </div>
                    <div class="space-y-2 sm:space-y-3">
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-0">
                            <label class="font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-gray-300 text-sm sm:text-base">Number of Mining Devices</label>
                            <span id="devices-value" class="text-blue-400 font-mono text-sm sm:text-base">100</span>
                        </div>
                        <input type="range" id="devices-slider" min="1" max="1000" value="100" class="w-full">
                        <div class="flex justify-between text-xs text-gray-500"><span>1</span><span>1,000</span></div>
                    </div>
                </div>
                <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4">
                    <div class="bg-gray-900/50 p-2 sm:p-3 rounded-lg text-center"><div id="total-hashrate" class="text-purple-400 font-mono text-sm sm:text-lg">60.0K H/s</div><div class="text-xs text-gray-400">Total Hashrate</div></div>
                    <div class="bg-gray-900/50 p-2 sm:p-3 rounded-lg text-center"><div id="network-share" class="text-blue-400 font-mono text-sm sm:text-lg">0.0021%</div><div class="text-xs text-gray-400">Network Share</div></div>
                    <div class="bg-gray-900/50 p-2 sm:p-3 rounded-lg text-center"><div id="xmr-price" class="text-green-400 font-mono text-sm sm:text-lg">$165</div><div class="text-xs text-gray-400">XMR Price</div></div>
                    <div class="bg-gray-900/50 p-2 sm:p-3 rounded-lg text-center"><div id="network-hashrate" class="text-yellow-400 font-mono text-sm sm:text-lg">2.8 GH/s</div><div class="text-xs text-gray-400">Network Hashrate</div></div>
                </div>
                <div class="space-y-3 sm:space-y-4">
                    <h4 class="text-base sm:text-lg font-semibold text-white flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-zap h-4 w-4 sm:h-5 sm:w-5 text-yellow-400"><path d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"></path></svg>Projected Earnings</h4>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4">
                        <div class="rounded-lg border bg-card text-card-foreground shadow-sm bg-gradient-to-br from-green-900/20 to-green-800/20 border-green-700/50"><div class="p-3 sm:p-4 text-center"><div id="daily-xmr" class="text-lg sm:text-2xl font-bold text-green-400">0.0093 XMR</div><div id="daily-usd" class="text-green-300 font-mono text-sm sm:text-base">$1.53</div><div class="text-xs sm:text-sm text-gray-400">Daily</div></div></div>
                        <div class="rounded-lg border bg-card text-card-foreground shadow-sm bg-gradient-to-br from-blue-900/20 to-blue-800/20 border-blue-700/50"><div class="p-3 sm:p-4 text-center"><div id="monthly-xmr" class="text-lg sm:text-2xl font-bold text-blue-400">0.28 XMR</div><div id="monthly-usd" class="text-blue-300 font-mono text-sm sm:text-base">$45.98</div><div class="text-xs sm:text-sm text-gray-400">Monthly</div></div></div>
                        <div class="rounded-lg border bg-card text-card-foreground shadow-sm bg-gradient-to-br from-purple-900/20 to-purple-800/20 border-purple-700/50 sm:col-span-2 lg:col-span-1"><div class="p-3 sm:p-4 text-center"><div id="yearly-xmr" class="text-lg sm:text-2xl font-bold text-purple-400">3.38 XMR</div><div id="yearly-usd" class="text-purple-300 font-mono text-sm sm:text-base">$559.21</div><div class="text-xs sm:text-sm text-gray-400">Yearly</div></div></div>
                    </div>
                </div>
                <div class="bg-yellow-900/20 border border-yellow-700/50 rounded-lg p-3 sm:p-4"><p class="text-yellow-400 text-xs sm:text-sm"><strong>Disclaimer:</strong> These calculations are estimates based on current network conditions. Actual earnings may vary due to network difficulty changes, XMR price fluctuations, and device performance variations.</p></div>
            </div>
        </div>
    </div>
    
    <!-- Your existing chat script -->
    <script>
        const messagesContainer = document.getElementById("messages");
        const messageInput = document.getElementById("message-input");
        const sendButton = document.getElementById("send-button");

        function addMessage(sender, text) {
            const messageDiv = document.createElement("div");
            messageDiv.classList.add("message", sender === "user" ? "user-message" : "eliza-message");
            const contentDiv = document.createElement("div");
            contentDiv.classList.add("content");
            // Use innerHTML to render line breaks from Eliza's greeting
            contentDiv.innerHTML = text.replace(/\n/g, '<br>');
            messageDiv.appendChild(contentDiv);
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        async function sendMessage() {
            const userText = messageInput.value.trim();
            if (!userText) return;

            addMessage("user", userText);
            messageInput.value = "";
            const processingMessage = addMessage("eliza", "Processing command...");

            try {
                // NOTE: This assumes your API endpoint is /api/chat. Adjust if needed.
                const response = await fetch("https://xmrtnet-eliza.onrender.com/api/chat", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ message: userText, character: 'xmrt_dao_governor' })
                });

                // Remove "Processing..." message
                if (messagesContainer.contains(processingMessage)) {
                   messagesContainer.removeChild(processingMessage);
                }
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                // The response from your current backend is a simple string
                addMessage("eliza", data.response || "No response field found.");

            } catch (error) {
                 if (messagesContainer.lastChild && messagesContainer.lastChild.textContent.includes("Processing")) {
                    messagesContainer.removeChild(messagesContainer.lastChild);
                }
                console.error("Fetch Error:", error);
                addMessage("eliza", "A communication error occurred. Please check the server logs and console.");
            }
        }

        sendButton.addEventListener("click", sendMessage);
        messageInput.addEventListener("keypress", (e) => {
            if (e.key === "Enter") {
                sendMessage();
            }
        });
    </script>

    <!-- =================================================================== -->
    <!-- NEW SCRIPT TO POWER THE CALCULATOR                                  -->
    <!-- =================================================================== -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- 1. CONFIGURATION & CONSTANTS ---
            // These are the core numbers that drive the calculations.
            const XMR_PRICE_USD = 165; // Current price of Monero
            const NETWORK_HASHRATE_GHS = 2.8; // Network hashrate in Gigahashes/sec
            const MONERO_BLOCK_TIME_SECONDS = 120; // ~2 minutes
            const MONERO_BLOCK_REWARD = 0.6; // Current tail emission block reward

            // Convert network hashrate to simple H/s for calculations
            const NETWORK_HASHRATE_HS = NETWORK_HASHRATE_GHS * 1_000_000_000;

            // Calculate blocks per day
            const SECONDS_IN_A_DAY = 24 * 60 * 60;
            const BLOCKS_PER_DAY = SECONDS_IN_A_DAY / MONERO_BLOCK_TIME_SECONDS;

            // --- 2. DOM ELEMENT SELECTORS ---
            // We grab all the HTML elements we need to read from or write to.
            const hashrateSlider = document.getElementById('hashrate-slider');
            const devicesSlider = document.getElementById('devices-slider');

            const hashrateValueEl = document.getElementById('hashrate-value');
            const devicesValueEl = document.getElementById('devices-value');

            const totalHashrateEl = document.getElementById('total-hashrate');
            const networkShareEl = document.getElementById('network-share');
            const xmrPriceEl = document.getElementById('xmr-price');
            const networkHashrateEl = document.getElementById('network-hashrate');
            
            const dailyXmrEl = document.getElementById('daily-xmr');
            const dailyUsdEl = document.getElementById('daily-usd');
            const monthlyXmrEl = document.getElementById('monthly-xmr');
            const monthlyUsdEl = document.getElementById('monthly-usd');
            const yearlyXmrEl = document.getElementById('yearly-xmr');
            const yearlyUsdEl = document.getElementById('yearly-usd');

            // --- 3. THE CORE CALCULATION FUNCTION ---
            // This function runs every time a slider is moved.
            function updateCalculations() {
                // Get current values from the sliders
                const hashratePerDevice = parseInt(hashrateSlider.value);
                const numberOfDevices = parseInt(devicesSlider.value);

                // --- Calculate intermediate values ---
                const totalUserHashrate = hashratePerDevice * numberOfDevices;
                const userNetworkShare = totalUserHashrate / NETWORK_HASHRATE_HS;

                // --- Calculate earnings ---
                const dailyXmrReward = userNetworkShare * BLOCKS_PER_DAY * MONERO_BLOCK_REWARD;
                const dailyUsdReward = dailyXmrReward * XMR_PRICE_USD;
                
                const monthlyXmrReward = dailyXmrReward * 30;
                const monthlyUsdReward = dailyUsdReward * 30;

                const yearlyXmrReward = dailyXmrReward * 365;
                const yearlyUsdReward = dailyUsdReward * 365;

                // --- 4. UPDATE THE UI (DOM MANIPULATION) ---
                // We update the text content of all the elements with the new values.
                // We use helper functions to make the numbers look nice.
                hashrateValueEl.textContent = `${hashratePerDevice} H/s`;
                devicesValueEl.textContent = `${numberOfDevices}`;

                totalHashrateEl.textContent = formatHashrate(totalUserHashrate);
                networkShareEl.textContent = `${(userNetworkShare * 100).toFixed(4)}%`;
                xmrPriceEl.textContent = `$${XMR_PRICE_USD}`;
                networkHashrateEl.textContent = `${NETWORK_HASHRATE_GHS} GH/s`;

                dailyXmrEl.textContent = `${dailyXmrReward.toFixed(4)} XMR`;
                dailyUsdEl.textContent = formatCurrency(dailyUsdReward);
                
                monthlyXmrEl.textContent = `${monthlyXmrReward.toFixed(2)} XMR`;
                monthlyUsdEl.textContent = formatCurrency(monthlyUsdReward);

                yearlyXmrEl.textContent = `${yearlyXmrReward.toFixed(2)} XMR`;
                yearlyUsdEl.textContent = formatCurrency(yearlyUsdReward);
            }

            // --- 5. HELPER FUNCTIONS for formatting numbers ---
            function formatHashrate(h) {
                if (h >= 1_000_000_000) return `${(h / 1_000_000_000).toFixed(2)} GH/s`;
                if (h >= 1_000_000) return `${(h / 1_000_000).toFixed(2)} MH/s`;
                if (h >= 1_000) return `${(h / 1_000).toFixed(1)}K H/s`;
                return `${h} H/s`;
            }

            function formatCurrency(n) {
                if (n >= 1000) {
                    return `$${(n / 1000).toFixed(1)}K`;
                }
                return `$` + n.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            }

            // --- 6. EVENT LISTENERS ---
            // This is what connects the user's actions to our calculation function.
            hashrateSlider.addEventListener('input', updateCalculations);
            devicesSlider.addEventListener('input', updateCalculations);

            // --- 7. INITIAL CALCULATION ---
            // Run the calculation once on page load to populate the initial values.
            updateCalculations();
        });
    </script>
</body>
</html>
