<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eliza | XMRT-DAO Command</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #0d1117;
            color: #c9d1d9;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        #main-content-wrapper {
            width: 80%;
            max-width: 800px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        #chat-container {
            width: 100%;
            height: 70vh;
            border: 1px solid #30363d;
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            background-color: #161b22;
        }
        #header { padding: 15px; border-bottom: 1px solid #30363d; text-align: center; }
        #header h1 { margin: 0; font-size: 1.5em; color: #58a6ff; }
        #header p { margin: 5px 0 0; color: #8b949e; }
        #messages { flex-grow: 1; overflow-y: auto; padding: 20px; border-bottom: 1px solid #30363d; }
        .message { margin-bottom: 15px; }
        .user-message { text-align: right; }
        .eliza-message .content { background-color: #21262d; display: inline-block; padding: 10px; border-radius: 10px; max-width: 80%; white-space: pre-wrap; text-align: left; }
        .user-message .content { background-color: #58a6ff; color: #161b22; display: inline-block; padding: 10px; border-radius: 10px; max-width: 80%; }
        #input-container { display: flex; padding: 10px; }
        #message-input { flex-grow: 1; background-color: #0d1117; border: 1px solid #30363d; border-radius: 6px; color: #c9d1d9; padding: 10px; font-family: inherit; }
        #send-button { background-color: #238636; color: white; border: none; padding: 10px 15px; margin-left: 10px; border-radius: 6px; cursor: pointer; }
        #send-button:hover { background-color: #2ea043; }

        /* Mining widget styles */
        #mining-widget-container {
            width: 100%;
            border: 1px solid #30363d;
            border-radius: 6px;
            background-color: #161b22;
            padding: 20px;
            box-sizing: border-box;
        }

        .widget-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 24px;
        }

        .widget-header h3 {
            color: #c9d1d9;
            font-size: 1.25rem;
            margin: 0;
        }

        .widget-header .icon {
            color: #58a6ff;
            width: 24px;
            height: 24px;
        }

        .slider-container {
            margin-bottom: 20px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .slider-label .label-text {
            color: #c9d1d9;
            font-size: 0.9rem;
        }

        .slider-label .value-display {
            color: #58a6ff;
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }

        /* Custom slider styles */
        .custom-slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #30363d;
            outline: none;
            -webkit-appearance: none;
            margin: 8px 0;
        }

        .custom-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #58a6ff;
            cursor: pointer;
            border: 2px solid #0d1117;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .custom-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #58a6ff;
            cursor: pointer;
            border: 2px solid #0d1117;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .slider-range {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: #8b949e;
            margin-top: 4px;
        }

        /* Stats grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin: 20px 0;
        }

        .stat-card {
            background-color: #21262d;
            padding: 12px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid #30363d;
        }

        .stat-value {
            font-size: 1.1rem;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #8b949e;
        }

        .purple { color: #c084fc; }
        .blue { color: #60a5fa; }
        .green { color: #4ade80; }
        .yellow { color: #facc15; }

        /* Earnings section */
        .earnings-section {
            margin-top: 20px;
        }

        .earnings-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
        }

        .earnings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .earnings-card {
            background: linear-gradient(135deg, #21262d 0%, #161b22 100%);
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 16px;
            text-align: center;
        }

        .earnings-xmr {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .earnings-usd {
            font-size: 0.9rem;
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }

        .earnings-period {
            font-size: 0.75rem;
            color: #8b949e;
        }

        /* Disclaimer */
        .disclaimer {
            background-color: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 6px;
            padding: 12px;
            margin-top: 20px;
        }

        .disclaimer-text {
            font-size: 0.8rem;
            color: #fbbf24;
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            #main-content-wrapper { width: 95%; }
            #chat-container { height: 60vh; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .earnings-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div id="main-content-wrapper">
        <div id="chat-container">
            <div id="header">
                <h1>Eliza Command Interface</h1>
                <p>XMRT-DAO Autonomous Operator</p>
            </div>
            <div id="messages">
                <div class="message eliza-message">
                    <div class="content">Greetings, Founder. I am Eliza, the autonomous operator for the XMRT-DAO Ecosystem. My systems are online and fully operational. How may I assist you?<br><br>Available commands: 'status', 'dashboard', 'health'.</div>
                </div>
            </div>
            <div id="input-container">
                <input type="text" id="message-input" placeholder="Enter command...">
                <button id="send-button">Send</button>
            </div>
        </div>

        <div id="mining-widget-container">
            <div class="widget-header">
                <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                </svg>
                <div>
                    <h3>MobileMonero Mining Calculator</h3>
                    <p style="margin: 0; font-size: 0.85rem; color: #8b949e;">Calculate potential earnings from mobile Monero mining</p>
                </div>
            </div>

            <div class="slider-container">
                <div class="slider-label">
                    <span class="label-text">Average Hashrate per Device</span>
                    <span class="value-display" id="hashrate-value">600 H/s</span>
                </div>
                <input type="range" id="hashrate-slider" class="custom-slider" min="200" max="1200" value="600" step="10">
                <div class="slider-range">
                    <span>200 H/s</span>
                    <span>1,200 H/s</span>
                </div>
            </div>

            <div class="slider-container">
                <div class="slider-label">
                    <span class="label-text">Number of Mining Devices</span>
                    <span class="value-display" id="devices-value">100</span>
                </div>
                <input type="range" id="devices-slider" class="custom-slider" min="1" max="1000000" value="100" step="1">
                <div class="slider-range">
                    <span>1</span>
                    <span>1M</span>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value purple" id="total-hashrate">60.0K H/s</div>
                    <div class="stat-label">Total Hashrate</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value blue" id="network-share">0.0021%</div>
                    <div class="stat-label">Network Share</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value green" id="xmr-price">$155</div>
                    <div class="stat-label">XMR Price</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value yellow" id="network-hashrate">2.8 GH/s</div>
                    <div class="stat-label">Network Hashrate</div>
                </div>
            </div>

            <div class="earnings-section">
                <div class="earnings-header">
                    <svg style="width: 20px; height: 20px; color: #facc15;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                    </svg>
                    <h4 style="margin: 0; color: #c9d1d9;">Projected Earnings</h4>
                </div>

                <div class="earnings-grid">
                    <div class="earnings-card">
                        <div class="earnings-xmr green" id="daily-xmr">0.0093 XMR</div>
                        <div class="earnings-usd green" id="daily-usd">$1.44</div>
                        <div class="earnings-period">Daily</div>
                    </div>
                    <div class="earnings-card">
                        <div class="earnings-xmr blue" id="monthly-xmr">0.28 XMR</div>
                        <div class="earnings-usd blue" id="monthly-usd">$43.40</div>
                        <div class="earnings-period">Monthly</div>
                    </div>
                    <div class="earnings-card">
                        <div class="earnings-xmr purple" id="yearly-xmr">3.38 XMR</div>
                        <div class="earnings-usd purple" id="yearly-usd">$524</div>
                        <div class="earnings-period">Yearly</div>
                    </div>
                </div>
            </div>

            <div class="disclaimer">
                <p class="disclaimer-text">
                    <strong>Disclaimer:</strong> These calculations are estimates based on current network conditions. 
                    Actual earnings may vary due to network difficulty changes, XMR price fluctuations, and device performance variations.
                </p>
            </div>
        </div>
    </div>

    <script>
        // Chat functionality
        const messagesContainer = document.getElementById("messages");
        const messageInput = document.getElementById("message-input");
        const sendButton = document.getElementById("send-button");

        function addMessage(sender, text) {
            const messageDiv = document.createElement("div");
            messageDiv.classList.add("message", sender === "user" ? "user-message" : "eliza-message");
            const contentDiv = document.createElement("div");
            contentDiv.classList.add("content");
            contentDiv.textContent = text;
            messageDiv.appendChild(contentDiv);
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        async function sendMessage() {
            const userText = messageInput.value.trim();
            if (!userText) return;

            addMessage("user", userText);
            messageInput.value = "";
            addMessage("eliza", "Processing command...");

            try {
                const response = await fetch("/api/chat", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ message: userText })
                });
                const data = await response.json();

                messagesContainer.removeChild(messagesContainer.lastChild);

                if (data.success) {
                    const formattedResponse = JSON.stringify(data.reply, null, 2);
                    addMessage("eliza", formattedResponse);
                } else {
                    addMessage("eliza", `Error: ${data.error}`);
                }
            } catch (error) {
                messagesContainer.removeChild(messagesContainer.lastChild);
                addMessage("eliza", "A communication error occurred. Please check the server logs.");
            }
        }

        sendButton.addEventListener("click", sendMessage);
        messageInput.addEventListener("keypress", (e) => {
            if (e.key === "Enter") {
                sendMessage();
            }
        });

        // Mining Calculator functionality
        const hashrateSlider = document.getElementById('hashrate-slider');
        const devicesSlider = document.getElementById('devices-slider');
        const hashrateValue = document.getElementById('hashrate-value');
        const devicesValue = document.getElementById('devices-value');

        // Display elements
        const totalHashrateDisplay = document.getElementById('total-hashrate');
        const networkShareDisplay = document.getElementById('network-share');
        const xmrPriceDisplay = document.getElementById('xmr-price');
        const networkHashrateDisplay = document.getElementById('network-hashrate');

        const dailyXmrDisplay = document.getElementById('daily-xmr');
        const dailyUsdDisplay = document.getElementById('daily-usd');
        const monthlyXmrDisplay = document.getElementById('monthly-xmr');
        const monthlyUsdDisplay = document.getElementById('monthly-usd');
        const yearlyXmrDisplay = document.getElementById('yearly-xmr');
        const yearlyUsdDisplay = document.getElementById('yearly-usd');

        // Constants for calculations
        const XMR_PRICE = 155; // USD
        const NETWORK_HASHRATE = 2800000000; // 2.8 GH/s in H/s
        const DAILY_XMR_EMISSION = 4320; // Approximate daily XMR emission

        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        function updateCalculations() {
            const hashrate = parseInt(hashrateSlider.value);
            const devices = parseInt(devicesSlider.value);

            // Update display values
            hashrateValue.textContent = hashrate + ' H/s';
            devicesValue.textContent = formatNumber(devices);

            // Calculate total hashrate
            const totalHashrate = hashrate * devices;
            totalHashrateDisplay.textContent = formatNumber(totalHashrate) + ' H/s';

            // Calculate network share
            const networkShare = (totalHashrate / NETWORK_HASHRATE) * 100;
            networkShareDisplay.textContent = networkShare.toFixed(4) + '%';

            // Calculate daily earnings
            const dailyXmr = (totalHashrate / NETWORK_HASHRATE) * DAILY_XMR_EMISSION;
            const dailyUsd = dailyXmr * XMR_PRICE;

            // Calculate monthly and yearly
            const monthlyXmr = dailyXmr * 30;
            const yearlyXmr = dailyXmr * 365;

            // Update earnings displays
            dailyXmrDisplay.textContent = dailyXmr.toFixed(4) + ' XMR';
            dailyUsdDisplay.textContent = '$' + dailyUsd.toFixed(2);
            monthlyXmrDisplay.textContent = monthlyXmr.toFixed(2) + ' XMR';
            monthlyUsdDisplay.textContent = '$' + (monthlyXmr * XMR_PRICE).toFixed(0);
            yearlyXmrDisplay.textContent = yearlyXmr.toFixed(2) + ' XMR';
            yearlyUsdDisplay.textContent = '$' + (yearlyXmr * XMR_PRICE).toFixed(0);
        }

        // Event listeners for sliders
        hashrateSlider.addEventListener('input', updateCalculations);
        devicesSlider.addEventListener('input', updateCalculations);

        // Initialize calculations
        updateCalculations();

        // Optional: Fetch live XMR price (you can uncomment this if you want live pricing)
        /*
        async function fetchXMRPrice() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=monero&vs_currencies=usd');
                const data = await response.json();
                const price = data.monero.usd;
                xmrPriceDisplay.textContent = '$' + price.toFixed(0);
                updateCalculations();
            } catch (error) {
                console.log('Could not fetch live XMR price, using default');
            }
        }

        // Fetch price on load and every 5 minutes
        fetchXMRPrice();
        setInterval(fetchXMRPrice, 300000);
        */
    </script>
</body>
</html>